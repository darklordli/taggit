webpackJsonp([12],{553:function(t,e,a){var i,r;a(554),i=a(555),r=a(556),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),r&&(("function"==typeof t.exports?t.exports.options:t.exports).template=r)},554:function(t,e){},555:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(6),s=i(r),o=a(11),n=i(o),l=a(9);i(l);e.default={name:"resouredetail",data:function(){return{logininfo:"",resouredata:{userinfo:""},detailtreedata:[],showtreedata:[],detailtaglist:[],taglist:[],classifylist:[],classifylistdisabled:[],taglistdisabled:[],verifytreedata:[],changedata:{keywords:[],clevel:"",artist:"",nickname:"",userinfo:{editor:"",editor_email:""}},verifydata:{clevel:"",check_info:"",userinfo:{reviewer:"",reviewer_email:""}}}},computed:{editdisable:function(){if(5===this.resouredata.clevel||3===this.resouredata.clevel||4===this.resouredata.clevel)return!0},clevel:function(){return n.default.getResouceStatus(this.resouredata.clevel)},id:function(){return this.$route.params.id},status:function(){return this.$route.query.action?this.$route.query.action:"detail"},dataformat:function(){return n.default.dataformat(this.resouredata.userinfo.edited_at)}},ready:function(){this.getlogininfo(),this.getresoure(),this.getclasslist()},methods:{getlogininfo:function(){this.logininfo=n.default.getCookie("CURRENT_USER"),this.logininfo=JSON.parse(JSON.parse(this.logininfo))},getresoure:function(){var t=this,e="/airesources/"+this.$route.params.id+"?tags=1&userinfo=1&tagnew=1&tagtree=1";n.default.ajax({method:"GET",url:n.default.getUrl(e)}).then(function(e){t.resouredata=e.data.data,t.resouredata.length=n.default.formatSeconds(t.resouredata.length),t.resouredata.size=n.default.formatFileSize(t.resouredata.size),t.resouredata.keywords=t.resouredata.keywords.join(","),t.edittree()}).catch(function(t){console.error(t)})},edittree:function(){this.detailtreedata.push(this.resouredata.tagnew),this.detailtaglist=n.default.gettaglist(this.detailtreedata),this.showtreedata.push(this.resouredata.tagtree),this.taglist=n.default.gettaglist(this.showtreedata)},getclasslist:function(){var t=this,e={appId:"",id:0,type:0};n.default.ajax({method:"POST",url:n.default.getUrl("/tag/list"),data:e}).then(function(e){t.classifylist=e.data.data.children,n.default.selectclass(t.classifylist,t.resouredata.catearr.id)}).catch(function(t){console.error(t)})},gettaglist:function(t){var e=this,a=0;if(console.log(t),t[0].id?a=t[0].id:t[0].tagId&&(a=t[0].tagId),a==this.resouredata.catearr.id)return this.taglist=n.default.gettaglist(this.showtreedata),!1;if(0!=t[0].pid)return!1;n.default.uncheckedtree(this.classifylist),n.default.unselecttree(this.classifylist),n.default.disableclass(this.classifylist,a);var i={appId:"",id:a};n.default.ajax({method:"POST",url:n.default.getUrl("/tag/list"),data:i}).then(function(t){e.taglist=t.data.data.children}).catch(function(t){console.error(t)}),this.changedata.tagnew=[],this.changedata.tagnew[0]=a},getcheckclass:function(t){var e=this;t.forEach(function(t){e.changedata.tagnew.push(t.id)})},selectclass:function(t){this.gettaglist(t),n.default.checkclass(this.classifylist,t)},getchecktags:function(t){var e=this;console.log(t),t[0].id?t.forEach(function(t){e.changedata.tagnew.push(t.id)}):t[0].tagId&&t.forEach(function(t){e.changedata.tagnew.push(t.tagId)})},toedit:function(){this.$router.go({name:"resouredetail",params:{id:this.$route.params.id},query:{action:"edit"}})},todetail:function(){this.$router.go({name:"resouredetail",params:{id:this.$route.params.id},query:{action:"detail"}})},tosave:function(){this.changedata.clevel=2,this.tosend()},tosubmit:function(){this.changedata.clevel=3,this.tosend()},tosend:function(){var t=this;this.changedata.keywords=this.resouredata.keywords.split(","),this.changedata.artist=this.resouredata.artist,this.changedata.nickname=this.resouredata.nickname,this.changedata.userinfo.editor=this.logininfo.loginName,this.changedata.userinfo.editor_email=this.logininfo.email;var e=new FormData;e.append("json",(0,s.default)(this.changedata));var a="/airesources/"+this.$route.params.id;n.default.ajax({method:"POST",url:n.default.getUrl(a),data:e}).then(function(e){n.default.tip(e),t.detailtreedata=[],t.showtreedata=[],t.detailtaglist=[],t.getresoure()}).catch(function(t){console.error(t)})},verifysuc:function(){this.verifydata.clevel=4,this.tosendverify()},verifyfail:function(){this.verifydata.clevel=2,this.tosendverify()},tosendverify:function(){var t=this;this.verifydata.userinfo.reviewer=this.logininfo.loginName,this.verifydata.userinfo.reviewer_email=this.logininfo.email;var e=new FormData;e.append("json",(0,s.default)(this.verifydata));var a="/airesources/"+this.$route.params.id;n.default.ajax({method:"POST",url:n.default.getUrl(a),data:e}).then(function(e){n.default.tip(e),t.getresoure()}).catch(function(t){console.error(t)})}}}},556:function(t,e){t.exports=' <div class=layout-header></div> <div class=layout-breadcrumb> <breadcrumb> <breadcrumb-item>首页</breadcrumb-item> <breadcrumb-item>音频资源管理</breadcrumb-item> <breadcrumb-item v-if="status==\'detail\'"> 资源详情 </breadcrumb-item> <breadcrumb-item v-if="status==\'edit\'"> 编辑资源 </breadcrumb-item> <breadcrumb-item v-if="status==\'verify\'"> 审核资源 </breadcrumb-item> </breadcrumb> </div> <div class=layout-content> <div class=layout-content-main> <card style=height:380px> <p slot=title style=height:35px> <icon type=ios-paper></icon> 基本信息 ( id: <tag color=blue>{{resouredata.id}}</tag> ) <tag type=dot color=yellow>{{{clevel}}}</tag> </p> <p slot=extra> 操作人：<span>{{resouredata.userinfo.editor}} ({{resouredata.userinfo.reviewer_email}})</span>， 操作时间：<span>{{dataformat}}</span> <i-button type=primary :disabled=editdisable icon=edit v-if="status==\'detail\'" v-on:click.stop.prevent=toedit()> 编辑资源 </i-button> <i-button type=primary icon=backspace v-if="status==\'edit\'" v-on:click.stop.prevent=todetail()> 返回查看 </i-button> </p> <i-col span=12> <i-form :label-width=120> <form-item label=资源名称：> {{resouredata.name}} </form-item> <form-item label=作者/歌手：> <span v-if="status==\'detail\'||status==\'verify\'"> {{resouredata.artist}} </span> <i-input v-if="status==\'edit\'" :value.sync=resouredata.artist> </i-input> </form-item> <form-item label=类型：>{{resouredata.type}}</form-item> <form-item label=时长：>{{resouredata.length}}</form-item> <form-item label=音频：> <audio :src=resouredata.content controls=controls> </audio> </form-item> </i-form> </i-col> <i-col span=12> <i-form :label-width=120> <form-item label=别名：> <span v-if="status==\'detail\'||status==\'verify\'"> {{resouredata.nickname}} </span> <i-input v-if="status==\'edit\'" :value.sync=resouredata.nickname> </i-input> </form-item> <form-item label=来源：>{{resouredata.srcname}}</form-item> <form-item label=大小：>{{resouredata.size}}</form-item> </i-form> </i-col> </card> <card> <p slot=title> <icon type=ios-paper></icon>关键词列表 </p> <i-form :label-width=120> <form-item label=预制关键词：> <span v-if="status==\'detail\'||status==\'verify\'"> {{resouredata.keywords}} </span> <i-input v-if="status==\'edit\'" :value.sync=resouredata.keywords> </i-input> </form-item> </i-form> </card> <card v-if="status==\'detail\'" class=tagwrapper> <p slot=title> <icon type=ios-paper></icon>分类/标签列表 </p> <i-form :label-width=60> <form-item label=分类：> <tree :data=detailtreedata></tree> </form-item> <form-item label=标签：> <p v-for="item in detailtaglist"> <tag type=dot color=red style=float:left;clear:both>{{item.title}}:</tag> <tree :data=item.children class=cf></tree> </p> </form-item> </i-form> </card> <card v-if="status==\'edit\'"> <p slot=title> <icon type=ios-paper></icon>分类/标签列表 </p> <card class="classwrapper cf"> <p slot=title>分类</p> <tree :data=classifylist @on-select-change=gettaglist @on-check-change=getcheckclass show-checkbox></tree> </card> <card class=tagwrapper> <p slot=title>标签</p> <template v-for="item in taglist"> <tag type=border color=blue>{{item.title}}</tag> <card class=cf> <tree :data=item.children show-checkbox @on-check-change=getchecktags></tree> </card> </template> </card> </card> <card v-if="status==\'verify\'"> <p slot=title> <icon type=ios-paper></icon>分类/标签列表 </p> <card class="classwrapper cf"> <p slot=title>分类</p> <tree :data=classifylist></tree> </card> <card class=tagwrapper> <p slot=title>标签</p> <template v-for="item in taglist"> <tag type=border color=blue>{{item.title}}</tag> <card class=cf> <tree :data=item.children show-checkbox> </tree> </card> </template> </card> </card> <div class=wrapper_editor> <icon type=person></icon> 操作人： <span>{{resouredata.userinfo.editor}} (<icon type=email></icon> {{resouredata.userinfo.editor_email}}) </span>， <icon type=clock></icon> 操作时间： <span>{{dataformat}}</span> </div> <template v-if="status==\'edit\'"> <p class=error_wrapper v-if=resouredata.check_info> <icon type=android-close></icon> 不合格原因：{{resouredata.check_info}} </p> <p class=btn_wrapper> <i-button type=warning icon=ios-compose size=large v-on:click.stop.prevent=tosave()>保存</i-button> <i-button type=success icon=checkmark-round size=large v-on:click.stop.prevent=tosubmit()>提交</i-button> </p> </template> <template v-if="status==\'verify\'"> <p class=error_wrapper> <icon type=android-close></icon> 不合格原因： <i-input type=textarea style=width:500px :value.sync=verifydata.check_info :autosize=true placeholder=请输入...> </i-input> </p> <div class=wrapper_editor> <icon type=person></icon> 审核人： <span>{{resouredata.userinfo.reviewer}} (<icon type=email></icon> {{resouredata.userinfo.reviewer_email}}) </span> <icon type=clock></icon> 审核时间： <span>{{resouredata.userinfo.reviewed_at}}</span> </div> <div class=btn_wrapper> <i-button type=success size=large icon=thumbsup :disabled="!verifydata.check_info == \'\'" v-on:click.stop.prevent=verifysuc()>审核通过</i-button> <i-button type=error icon=thumbsdown size=large :disabled=!verifydata.check_info v-on:click.stop.prevent=verifyfail()>审核未通过</i-button> </div> </template> </div> </div> '}});